<md-content>
    <md-content
      ng-if="vm.options.withCreate"
      layout-padding
      layout="row"
      layout-align="center stretch">
        <md-button ng-click="createItem()"
          layout-fill
          class="md-raised md-primary">
          <span translate>{{vm.options.layout.labels.create}}</span>
        </md-button>
    </md-content>
    <md-content
        ng-if="vm.options.withSearch"
        layout="row"
        layout-xs="column"
        layout-align="space-around center"
        layout-align-xs="center stretch"
        layout-margin
        class="md-whiteframe-1dp">
        <md-input-container>
            <md-select ng-model="vm.sortOrder" aria-label="Sort order">
                <md-option value="ASC">
                    <md-icon md-svg-icon="img/icons/up-arrow.svg"></md-icon>
                </md-option>
                <md-option value="DSC">
                    <md-icon md-svg-icon="img/icons/down-arrow.svg"></md-icon>
                </md-option>
            </md-select>
        </md-input-container>
        <md-input-container>
            <md-select ng-model="vm.filterField" ng-change="changeFilterField()" aria-label="Filter field">
                <md-option
                    ng-repeat="field in allFields"
                    ng-value="field" translate>{{(vm.options.layout.labels[field]) ? vm.options.layout.labels[field] : field}}</md-option>
            </md-select>
        </md-input-container>
        <md-autocomplete
          ng-if="!vm.options.layout.formats[vm.filterField] || vm.options.layout.formats[vm.filterField] === 'tags'"
          flex
          class="md-block"
          md-input-name="autocompleteField"
          md-no-cache="false"
          md-selected-item="vm.selectedItem"
          md-search-text-change="searchTextChange(vm.searchText)"
          md-search-text="vm.searchText"
          md-selected-item-change="selectedItemChange(vm.item)"
          md-items="item in querySearch(vm.searchText)"
          md-item-text="getField(item, vm.filterField)"
          md-min-length="2"
          placeholder="{{'GRID.SEARCH_ITEMS' | translate}}">
          <md-item-template>
            <span md-highlight-text="vm.searchText" md-highlight-flags="^i">{{(Array.isArray(item[vm.filterField])) ? item[vm.options.layout.title] + ' - ' + item[vm.filterField].join(', ') : item[vm.options.layout.title] + ' - ' + item[vm.filterField]}}</span>
          </md-item-template>
          <md-not-found>
            <a ng-click="newItem(vm.searchText)" translate translate-value-search="{{vm.searchText}}">GRID.NO_ITEMS_FOUND</a>
          </md-not-found>
        </md-autocomplete>
        <md-content
          ng-if="vm.options.layout.formats[vm.filterField] === 'date'"
          flex
          layout="row"
          class="md-block date-filter-container">
          <md-datepicker ng-model="vm.dateFrom" md-placeholder="{{'GRID.DATE.FROM' | translate}}"
              md-open-on-focus
              flex="grow"
              ng-change="changeDateFrom()"
              md-min-date="minDate" md-max-date="maxDate"></md-datepicker>
          <md-datepicker ng-model="vm.dateTo" md-placeholder="{{'GRID.DATE.TO' | translate}}"
              md-open-on-focus
              flex="grow"
              ng-disabled="!vm.dateFrom"
              md-min-date="vm.dateFrom" md-max-date="maxDate"></md-datepicker>
        </md-content>
        <md-content flex=20
          flex-xs=100>
        <md-button ng-click="addFilter()"
          layout-fill
          class="md-raised md-primary">
          <span translate>GRID.FILTER.ADD</span>
        </md-button>
        </md-content>
    </md-content>
    <md-content layout="row"
      layout-xs="column"
      layout-align="start stretch"
      flex
      ng-if="filters.length > 0"
      layout-align-xs="center stretch"
      layout-margin>
      <md-chips class="custom-chips"
           name="filters"
           readonly="true"
           md-removable="true"
           ng-model="filters">
         <md-chip-template>
           <span>
             <md-icon ng-if="$chip.order === 'ASC'" md-svg-icon="img/icons/up-arrow.svg"></md-icon>
             <md-icon ng-if="$chip.order === 'DSC'" md-svg-icon="img/icons/down-arrow.svg"></md-icon>
             <b>{{$chip.label}}</b>
           </span>
         </md-chip-template>
         <button md-chip-remove class="md-primary" type="button">
           <md-icon md-svg-icon="img/icons/close.svg"></md-icon>
         </button>
      </md-chips>
    </md-content>
    <md-content
        ng-if="vm.options.withSelector"
        layout="row"
        layout-align="space-between center"
        layout-margin
        class="md-whiteframe-1dp">
        <md-input-container>
          <md-checkbox aria-label="Select All"
              ng-checked="allChecked()"
              md-indeterminate="isIndeterminate()"
              ng-click="toggleAll()"
              class="md-primary list-checkbox">
            <span ng-if="allChecked()" translate>GRID.UNSELECT_ALL</span>
            <span ng-if="!allChecked()" translate>GRID.SELECT_ALL</span>
          </md-checkbox>
        </md-input-container>
        <md-button aria-label="Delete" ng-click="deleteItems(vm.selected)"><span translate>COMMON.DELETE</span> ({{vm.selected.length}})</md-button>
    </md-content>
    <md-list>
        <md-list-item
            ng-if="!vm.items || vm.items.length === 0"
            flex
            layout-padding>
            <span translate>GRID.NO_DATA_FOUND</span>
        </md-list-item>
        <md-list-item
            ng-repeat="item in vm.items"
            class="md-whiteframe-1dp"
            ng-click="rowClick(item)">
            <md-checkbox
                ng-if="vm.options.withSelector"
                ng-checked="exists(item)"
                class="md-primary"
                ng-click="toggle(item)"
                aria-label="Select item"></md-checkbox>
            <div layout="row"
                layout-xs="column"
                layout-align-xs="space-between start"
                layout-align="space-between center"
                flex
                layout-padding>
                <b>{{item[vm.options.layout.title]}}</b>
                <div ng-repeat="description in vm.options.layout.description">
                  <span ng-if="!vm.options.layout.formats[description]">{{item[description]}}</span>
                  <md-chips ng-if="vm.options.layout.formats[description] === 'tags'"
                    ng-repeat="tag in item[description] track by $index">
                    <md-chip>{{tag}}</md-chip>
                  </md-chips>
                  <span ng-if="vm.options.layout.formats[description] === 'date'">{{item[description] | amFromUnix | amLocal | amDateFormat:'MM.DD.YYYY HH:mm:ss'}}</span>
                  <md-checkbox class="list-checkbox" ng-if="vm.options.layout.formats[description] === 'check'" aria-label="item check" ng-disabled="true" ng-model="item[description]">
                  <md-divider hide show-xs></md-divider>
                </div>
                <div ng-if="vm.options.layout.corner">{{item[vm.options.layout.corner]}}</div>
            </div>
            <!-- <md-icon class="md-secondary" ng-click="editItem(item)" aria-label="Edit" md-svg-icon="img/icons/launch.svg"></md-icon> -->
            <md-menu ng-if="vm.options.layout.menu">
              <md-button
                  ng-click="$mdOpenMenu()"
                  class="md-icon-button"
                  aria-label="Open row interactions menu">
                  <md-icon md-svg-icon='img/icons/more_vert.svg'></md-icon>
              </md-button>
              <md-menu-content width="2">
                <md-menu-item ng-repeat="menu in vm.options.layout.menu">
                  <md-button ng-click="vm.options.controllerAction[menu.action](item)">
                    <spam translate>{{menu.label}}</span>
                  </md-button>
                </md-menu-item>
              </md-menu-content>
            </md-menu>
        </md-list-item>
    </md-list>
</md-content>
